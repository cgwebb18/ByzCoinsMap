<!DOCTYPE HTML>
<html>

<head>
  <title>ByzCoinsMap</title>
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.49.0/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.49.0/mapbox-gl.css' rel='stylesheet' />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="m_style.css" />

</head>

<body>
  <nav id='menu'></nav>
  <div id='map'></div>
  <script type="text/javascript">
    //initialize map
    //public token, change this to put it in production
    mapboxgl.accessToken = 'pk.eyJ1IjoiY2d3ZWJiMTgiLCJhIjoiY2psd3FhMTMwMDFjNjN2b3Zmd3JyMWV2ZSJ9.r8XM2Wrgj6kueUh3Jdo3iw';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v9',
      //TODO: change center + zoom based on points represented in map
      center: [18.465510, 41.768844],
      zoom: 3.8,
      crossSourceCollisions: false
    });
    map.on('load', function() {
      map.addSource('mints', {
        "type": "geojson",
        "data": "mints.geojson"
      });
      map.addLayer({
        "id": "mints",
        "type": "circle",
        "source": "mints",
        "paint": {
          "circle-color": "#FF0000"
        }
      });
    });
    //preview names of places on mouseover
    var popup = {};
    map.on('mouseover', 'mints', function(e) {
      var layer = e.features[0].layer.id
      var features = e.features;
      var coordinates = e.features[0].geometry.coordinates.slice();
      var place_n = e.features[0].properties["Mint"];
      popup = new mapboxgl.Popup({
          closeButton: false
        })
        .setLngLat(coordinates)
        .setHTML('<h4>' + place_n + '</h4>')
        .addTo(map);
    });
    // Change it back to a pointer when it leaves.
    map.on('mouseleave', 'mints', function() {
      popup.remove();
      map.getCanvas().style.cursor = '';
    });
  </script>
</body>

</html>